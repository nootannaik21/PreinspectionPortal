<div class="row">
  <div class="col text-left">
    <h3>{{ title }}</h3>
  </div>
</div>
<div class="row">&nbsp;</div>
<div class="row">
  <div class="col-sm-12">
    <app-card [hidHeader]="true" [options]="false">
      <form [formGroup]="addUserForm" (ngSubmit)="onSubmit()">
        <h5>User Profile</h5>
        <hr />
        <div class="row">
          <!--First Name-->
          <div class="col-md-6">
            <div class="form-group">
              <label for="exampleInputEmail1">First Name</label>
              <input
                type="text"
                class="form-control"
                aria-describedby="emailHelp"
                tabindex="1"
                placeholder="First Name"
                formControlName="firstName"
                [(ngModel)]="userdata.firstName"
                appOnlyalphabets
                [onlyAlpha]="true"
                (keypress)="avoidSpecialchar($event)"
                [ngClass]="{ 'is-invalid': submitted && f.firstName.errors }"
              />
              <div
                *ngIf="submitted && f.firstName.errors"
                class="invalid-feedback"
              >
                <div *ngIf="f.firstName.errors.required">
                  First Name is required
                </div>
              </div>
            </div>
          </div>
          <!--End of First Name-->
          <!--Last Name-->
          <div class="col-md-6">
            <div class="form-group">
              <label for="exampleInputPassword1">Last Name</label>
              <input
                type="text"
                class="form-control"
                placeholder="Last Name"
                tabindex="2"
                formControlName="lastName"
                [(ngModel)]="userdata.lastName"
                (keypress)="avoidSpecialchar($event)"
                appOnlyalphabets
                [onlyAlpha]="true"
                [ngClass]="{ 'is-invalid': submitted && f.lastName.errors }"
              />
              <div
                *ngIf="submitted && f.lastName.errors"
                class="invalid-feedback"
              >
                <div *ngIf="f.lastName.errors.required">
                  Last Name is required
                </div>
              </div>
            </div>
          </div>
          <!--End of Last Name-->
          <!--Email-->
          <div class="col-md-6">
            <div class="form-group">
              <label>Email</label>
              <input
                type="email"
                class="form-control"
                placeholder="Email"
                formControlName="email"
                [(ngModel)]="userdata.email"
                tabindex="3"
                [ngClass]="{ 'is-invalid': submitted && f.email.errors }"
              />
              <div *ngIf="submitted && f.email.errors" class="invalid-feedback">
                <div *ngIf="f.email.errors.required">Email is required</div>
                <div *ngIf="f.email.errors.pattern">
                  Email must be a valid email address
                </div>
              </div>
            </div>
          </div>
          <!--End of Email-->
          <!--Company Name-->
          <div class="col-md-6">
            <div class="form-group" *ngIf="!showVendorOrganization">
              <label>Company Name</label>
              <input
                type="text"
                class="form-control"
                placeholder="Company Name"
                formControlName="company"
                oninput="this.value = this.value.replace(/[^A-Za-z0-9-!*@#$%^&,.;'&/.() ]|^ /g,'')"
                [(ngModel)]="userdata.company"
                tabindex="4"
                [ngClass]="{ 'is-invalid': submitted && f.company.errors }"
              />
              <div
                *ngIf="submitted && f.company.errors"
                class="invalid-feedback"
              >
                <div *ngIf="f.company.errors.required">
                  Company Name is required
                </div>
              </div>
            </div>
          </div>
          <!--End of Company Name-->
          <!--Password-->
          <div class="col-md-6">
            <div class="form-group">
              <ng-template #htmlTooltip class="text-left">
                <br />
                <p class="text-left">Minimum 8 characters.</p>
                <p class="text-left">Must have an UPPERCASE and lowercase.</p>
                <p class="text-left">
                  Should have atleast one numeric value and one special
                  character.
                </p>
              </ng-template>
              <label>Password </label> &nbsp;<i
                class="fa fa-info-circle"
                aria-hidden="true"
                [ngbTooltip]="htmlTooltip"
              ></i>
              <input
                type="password"
                class="form-control"
                placeholder="Password"
                formControlName="password"
                tabindex="4"
                [(ngModel)]="userdata.password"
                [ngClass]="{ 'is-invalid': submitted && f.password.errors }"
              />
              <div
                *ngIf="submitted && f.password.errors"
                class="invalid-feedback"
              >
                <div *ngIf="f.password.errors.required">
                  Password is required
                </div>
                <div *ngIf="f.password.length < 8">
                  Password must be minimum 8 characters
                </div>
                <div *ngIf="f.password.errors.pattern">
                  Password Not Matching minimum criteria
                </div>
              </div>
            </div>
          </div>
          <!--End of Password-->
          <!--Confirm Password-->
          <div class="col-md-6">
            <div class="form-group">
              <label>Confirm Password</label>
              <input
                type="password"
                class="form-control"
                formControlName="confPassword"
                placeholder="Confirm Password"
                [(ngModel)]="userdata.confPassword"
                tabindex="5"
                [ngClass]="{ 'is-invalid': submitted && f.confPassword.errors }"
              />
              <div
                *ngIf="submitted && f.confPassword.errors"
                class="invalid-feedback"
              >
                <div *ngIf="f.confPassword.errors.required">
                  Confirm Password is required
                </div>
              </div>
            </div>
          </div>
          <!--End of Confirm Password-->
          <div class="col-md-6" *ngIf="imdUser">
            <div class="form-group">
              <label for="exampleInputEmail1">IMD Code</label>
              <input
                type="text"
                class="form-control"
                aria-describedby="emailHelp"
                tabindex="7"
                placeholder="IMD Code"
                formControlName="IMDCode"
                [(ngModel)]="userdata.imdCode"
                [ngClass]="{ 'is-invalid': submitted && f.IMDCode.errors }"
              />
              <div
                *ngIf="submitted && f.IMDCode.errors"
                class="invalid-feedback"
              >
                <div *ngIf="f.IMDCode.errors.pattern">
                  IMD Code is required
                </div> 
              </div>
            </div>
          </div>
        </div>
        <br />
        <h5>User Role and Authorization</h5>
        <hr />
        <div class="row">
          <!--User Type-->
          <div class="col-md-6">
            <div class="form-group">
              <label for="exampleFormControlSelect1">User Type</label>
              <select
                class="form-control"
                formControlName="type"
                [(ngModel)]="userdata.type"
                tabindex="6"
                (change)="onTypeSelect($event)"
                [ngClass]="{ 'is-invalid': submitted && f.type.errors }"
              >
              <option value="">Choose User Type</option>
                <option value="Admin">Admin</option>
                <option value="OPS">OPS</option>
                <option value="IMD">IMD</option>
                <option value="Branch">Branch</option>
                <option value="Vendor">Vendor</option>
                <option value="Claims">Claims</option>
              </select>
              <div *ngIf="submitted && f.type.errors" class="invalid-feedback">
                <div *ngIf="f.type.errors.required">User Type is required</div>
              </div>
            </div>
          </div>
          <!--End of User Type-->
          <!--Branches-->
          <div class="col-md-6">
            <div class="form-group" *ngIf="showBranch">
              <label for="exampleFormControlSelect1">Pin Code</label>
              <ng-multiselect-dropdown
                [placeholder]="'Choose Pin/Location'"
                [settings]="dropdownSettings"
                [data]="branches"
                tabindex="7"
                [(ngModel)]="selectedItems"
                formControlName="branches"
                (onSelect)="onItemSelect($event)"
                (onSelectAll)="onSelectAll($event)"
                [ngClass]="{ 'is-invalid': submitted && f.branches.errors }"
              >
              </ng-multiselect-dropdown>
              <div
                *ngIf="submitted && f.branches.errors"
                class="invalid-feedback"
              >
                <div *ngIf="f.branches.errors.required">Pin/Location required</div>
              </div>
            </div>
              <div class="form-group" *ngIf="showBranchDetail">
                <label for="exampleFormControlSelect1">Pin/Location</label>
                <select
                  class="form-control"
                  formControlName="branchName"
                  [(ngModel)]="userdata.branchCode"
                  tabindex="8"
                  [ngClass]="{ 'is-invalid': submitted && f.branchName.errors }"
                  placeholder="Select Branch Name"
                >
                  <option value="">Choose Pin/Location</option>
                  <option
                    class="form-control"
                    *ngFor="let item of branches"
                    [value]="item.branchCode"
                  >
                    <table>
                      <tr>
                        <td>{{ item.branchCode }}</td>
                      </tr>
                    </table>
                  </option>
                </select>
                <div
                  *ngIf="submitted && f.branchName.errors"
                  class="invalid-feedback"
                >
                  <div *ngIf="f.branchName.errors.required">
                    Pin Code/Locatin is required
                  </div>
                </div>
              </div>
          </div>
          <!--End of Branches-->
          <!--Branches Name-->
         
          <!--End of Branches Name-->
          <!--Branch Code-->
          <!-- <div class="col-md-6" *ngIf="showBranchDetail">
            <div class="form-group" *ngIf="showBranchDetail">
              <label for="exampleFormControlSelect1">Branch Code</label>
              <select
                class="form-control"
                formControlName="branchCode"
                [(ngModel)]="userdata.branchCode"
                tabindex="9"
                (change)="onBranchCodeSelect()"
                [ngClass]="{ 'is-invalid': submitted && f.branchCode.errors }"
              >
                <option value="">Choose Branch Code</option>
                <option
                  class="form-control"
                  *ngFor="let item of branches"
                  [value]="item.branchCode"
                >
                  <table>
                    <tr>
                      <td>{{ item.branchCode }}</td>
                    </tr>
                  </table>
                </option>
              </select>
              <div
                *ngIf="submitted && f.branchCode.errors"
                class="invalid-feedback"
              >
                <div *ngIf="f.branchCode.errors.required">
                  Branch Code is required
                </div>
              </div>
            </div>
          </div> -->
          <!--End of Branch Code-->


          <div class="col-md-6" *ngIf="showVendorOrganization">
            <label for="vendorOrganization">Vendor</label>
            <select
              class="form-control"
              formControlName="vendor"
              [(ngModel)]="userdata.vendorOrganization"
              tabindex="9"
              (change)="onVendorSelect($event)"
            >
              <option value="">Choose Vendor</option>
              <option
                class="form-control"
                *ngFor="let item of vendorOganization"
                [value]="item.inspectionemail"
              [ngClass]="{ 'is-invalid': submitted && f.vendor.errors }"
              >
                <table>
                  <tr>
                    <td>{{ item.vendorname }}({{item.inspectionemail}})</td>
                  </tr>
                </table>
              </option>
            </select>
            </div>
            <div class="col-md-6" *ngIf="showVendorOrganization">
              <label for="exampleFormControlSelect1">Vendor</label>
              <ng-multiselect-dropdown
                [placeholder]="'Choose vendor'"
                [settings]="dropdownSettings"
                [data]="branchList"
                tabindex="7"
                [(ngModel)]="selectedItems"
                formControlName="vendorList"
                (onSelect)="onItemSelect($event)"
                (onSelectAll)="onSelectAll($event)"
                [ngClass]="{ 'is-invalid': submitted && f.vendorList.errors }"
              >
              </ng-multiselect-dropdown>
              <div
                *ngIf="submitted && f.vendorList.errors"
                class="invalid-feedback"
              >
                <div *ngIf="f.vendorList.errors.required">Vendor required</div>
              </div>
            </div>
          <!--Status-->
          <div class="col-md-6">
            <div class="form-group" *ngIf="userdata.id != undefined">
              <label for="exampleFormControlSelect1">Status</label>
              <select
                class="form-control"
                formControlName="status"
                [(ngModel)]="userdata.status"
                tabindex="10"
                (change)="onStatusSelect($event)"
                [ngClass]="{ 'is-invalid': submitted && f.status.errors }"
              >
                <option value="false">Active</option>
                <option value="true">In Active</option>
              </select>
              <div
                *ngIf="submitted && f.status.errors"
                class="invalid-feedback"
              >
                <div *ngIf="f.status.errors.required">Status is required</div>
              </div>
            </div>
            
          </div>
          <!--End of Status-->
         
        </div>
        <br />
        <div class="row float-right">
         
            <div class="col-12">
              <button
                type="button"
                class="btn btn-secondary mr-1"
                (click)="reset()"
              >
                Cancel
              </button>
              <button
                type="submit"
                class="btn btn-primary"
                *ngIf="userdata.id == undefined"
              >
                Add User
              </button>
              <button
                type="button"
                class="btn btn-primary"
                *ngIf="userdata.id != undefined"
                (click)="updateUser(userdata)"
              >
                Update
              </button>
            </div>
          </div>
      </form>
    </app-card>
  </div>
</div>
